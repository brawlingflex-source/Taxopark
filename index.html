<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏–º—É–ª—è—Ç–æ—Ä —Ç–∞–∫—Å–∏ 2D</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #000;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #fff;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        #gameContainer {
            position: relative;
            width: 100%;
            max-width: 1000px;
            height: 600px;
            border: 2px solid #444;
            background-color: #000;
            overflow: hidden;
        }
        
        #roadCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        #taxi {
            position: absolute;
            z-index: 2;
            cursor: pointer;
            transition: transform 0.2s;
            filter: drop-shadow(0 0 5px rgba(255, 204, 0, 0.7));
        }
        
        #taxi:hover {
            transform: scale(1.05);
        }
        
        .modal {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(30, 30, 40, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(255, 204, 0, 0.5);
            z-index: 10;
            width: 350px;
            border: 2px solid #ffcc00;
        }
        
        .modal.active {
            display: block;
            animation: modalFade 0.3s;
        }
        
        @keyframes modalFade {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }
        
        h2 {
            color: #ffcc00;
            margin-bottom: 20px;
            text-align: center;
            font-size: 24px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #ddd;
        }
        
        input {
            width: 100%;
            padding: 12px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid #555;
            border-radius: 6px;
            color: #fff;
            font-size: 16px;
        }
        
        input:focus {
            outline: none;
            border-color: #ffcc00;
        }
        
        .button {
            background-color: #ffcc00;
            color: #000;
            border: none;
            padding: 14px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.3s;
        }
        
        .button:hover {
            background-color: #ffd633;
        }
        
        .button:active {
            transform: scale(0.98);
        }
        
        #completionMessage {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 60, 0, 0.9);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.5);
            z-index: 10;
            width: 350px;
            border: 2px solid #00cc00;
            text-align: center;
        }
        
        #completionMessage.active {
            display: block;
            animation: completionFade 0.5s;
        }
        
        @keyframes completionFade {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }
        
        .completion-text {
            color: #00ff00;
            font-size: 28px;
            margin-bottom: 20px;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(0, 255, 0, 0.7);
        }
        
        .info-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: rgba(30, 30, 40, 0.8);
            padding: 15px;
            border-radius: 10px;
            z-index: 5;
            border: 1px solid #555;
            min-width: 200px;
        }
        
        .info-title {
            color: #ffcc00;
            font-size: 18px;
            margin-bottom: 10px;
            border-bottom: 1px solid #444;
            padding-bottom: 5px;
        }
        
        .info-item {
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .info-label {
            color: #aaa;
        }
        
        .info-value {
            color: #fff;
            font-weight: bold;
        }
        
        .price-control {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 5px;
        }
        
        .price-button {
            background-color: rgba(255, 204, 0, 0.2);
            color: #ffcc00;
            border: 1px solid #ffcc00;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .price-button:hover {
            background-color: rgba(255, 204, 0, 0.3);
        }
        
        .hidden-price {
            color: #666 !important;
            font-style: italic;
        }
        
        #taxiCountdown {
            color: #ffcc00;
            font-size: 20px;
        }
        
        #realTimeCountdown {
            color: #00ff00;
            font-size: 20px;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .instructions {
            position: absolute;
            bottom: 20px;
            left: 20px;
            color: #888;
            font-size: 14px;
            z-index: 5;
        }
        
        .time-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: rgba(30, 30, 40, 0.8);
            padding: 15px;
            border-radius: 10px;
            z-index: 5;
            border: 1px solid #555;
            min-width: 250px;
        }
        
        .time-title {
            color: #00ccff;
            font-size: 18px;
            margin-bottom: 10px;
            border-bottom: 1px solid #444;
            padding-bottom: 5px;
        }
        
        .time-item {
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .time-label {
            color: #aaa;
        }
        
        .time-value {
            color: #fff;
            font-weight: bold;
            font-size: 18px;
        }
        
        .urgent {
            color: #ff5555 !important;
            animation: urgentPulse 0.8s infinite;
        }
        
        @keyframes urgentPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .sound-controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background-color: rgba(30, 30, 40, 0.8);
            padding: 15px;
            border-radius: 10px;
            z-index: 5;
            border: 1px solid #555;
            display: flex;
            flex-direction: column;
            gap: 10px;
            min-width: 180px;
        }
        
        .sound-control-group {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .sound-label {
            color: #aaa;
            font-size: 14px;
            margin-right: 10px;
        }
        
        .sound-button {
            background: none;
            border: none;
            color: #ffcc00;
            font-size: 20px;
            cursor: pointer;
            padding: 5px 8px;
            border-radius: 5px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 36px;
        }
        
        .sound-button:hover {
            background-color: rgba(255, 204, 0, 0.2);
        }
        
        .sound-button.muted {
            color: #888;
            opacity: 0.7;
        }
        
        .sound-button:focus {
            outline: none;
        }
        
        .sound-status {
            font-size: 12px;
            color: #aaa;
            margin-top: 5px;
            text-align: center;
        }
        
        .car-effects {
            position: absolute;
            bottom: 140px;
            right: 20px;
            background-color: rgba(30, 30, 40, 0.8);
            padding: 10px;
            border-radius: 10px;
            z-index: 5;
            border: 1px solid #555;
            font-size: 12px;
            color: #aaa;
            max-width: 200px;
        }
        
        .light-effect {
            position: absolute;
            width: 15px;
            height: 4px;
            background: radial-gradient(circle, rgba(255,255,200,0.8) 0%, rgba(255,255,100,0.4) 70%, transparent 100%);
            border-radius: 50%;
            filter: blur(1px);
            z-index: 3;
        }
        
        .exhaust-effect {
            position: absolute;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, rgba(100,100,100,0.7) 0%, rgba(50,50,50,0.3) 70%, transparent 100%);
            border-radius: 50%;
            filter: blur(2px);
            z-index: 1;
        }
        
        .city-lights {
            position: absolute;
            width: 3px;
            height: 3px;
            background-color: rgba(255, 255, 200, 0.8);
            border-radius: 50%;
            box-shadow: 0 0 5px 2px rgba(255, 255, 200, 0.5);
            z-index: 0;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="roadCanvas"></canvas>
        
        <!-- –≠—Ñ—Ñ–µ–∫—Ç—ã —Ñ–∞—Ä –∏ –≤—ã—Ö–ª–æ–ø–∞ -->
        <div id="carEffects"></div>
        
        <!-- –ì–æ—Ä–æ–¥—Å–∫–∏–µ –æ–≥–Ω–∏ -->
        <div id="cityLights"></div>
        
        <div id="taxi">
            <svg width="80" height="40" viewBox="0 0 80 40">
                <!-- –ö—É–∑–æ–≤ —Ç–∞–∫—Å–∏ -->
                <rect x="10" y="10" width="60" height="20" rx="5" fill="#FFCC00" stroke="#CC9900" stroke-width="2"/>
                
                <!-- –û–∫–Ω–∞ -->
                <rect x="15" y="12" width="20" height="8" rx="2" fill="#87CEEB"/>
                <rect x="45" y="12" width="20" height="8" rx="2" fill="#87CEEB"/>
                
                <!-- –ö–æ–ª–µ—Å–∞ -->
                <circle cx="20" cy="32" r="6" fill="#333"/>
                <circle cx="20" cy="32" r="3" fill="#666"/>
                <circle cx="60" cy="32" r="6" fill="#333"/>
                <circle cx="60" cy="32" r="3" fill="#666"/>
                
                <!-- –®–∞—à–µ—á–∫–∏ -->
                <rect x="35" y="12" width="10" height="8" fill="#000"/>
                <rect x="36" y="13" width="8" height="2" fill="#FFCC00"/>
                <rect x="36" y="16" width="8" height="2" fill="#FFCC00"/>
                <rect x="36" y="19" width="8" height="2" fill="#FFCC00"/>
                
                <!-- –§–∞—Ä—ã -->
                <circle cx="8" cy="20" r="3" fill="#FFDD00" class="headlight"/>
                <circle cx="72" cy="20" r="3" fill="#FF3333" class="taillight"/>
            </svg>
        </div>
        
        <div id="orderModal" class="modal">
            <h2>–ó–∞–∫–∞–∑ —Ç–∞–∫—Å–∏</h2>
            <form id="taxiForm">
                <div class="form-group">
                    <label for="address">–ê–¥—Ä–µ—Å –ø–æ–µ–∑–¥–∫–∏:</label>
                    <input type="text" id="address" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 10" required>
                </div>
                
                <div class="form-group">
                    <label for="price">–°—Ç–æ–∏–º–æ—Å—Ç—å (—Ä—É–±):</label>
                    <input type="number" id="price" min="100" max="5000" value="350" required>
                </div>
                
                <div class="form-group">
                    <label for="time">–í—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏ (–º–∏–Ω):</label>
                    <input type="number" id="time" min="1" max="120" value="3" required>
                </div>
                
                <button type="submit" class="button">–ù–∞—á–∞—Ç—å –ø–æ–µ–∑–¥–∫—É</button>
            </form>
        </div>
        
        <div id="completionMessage">
            <div class="completion-text">–ü–æ–µ–∑–¥–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</div>
            <div class="info-item" style="margin-bottom: 20px;">
                <span class="info-label">–°—Ç–æ–∏–º–æ—Å—Ç—å:</span>
                <span class="info-value" id="finalPrice">0 —Ä—É–±</span>
            </div>
            <button id="backToMenu" class="button">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>
        </div>
        
        <div class="info-panel" style="display: none;" id="tripInfo">
            <div class="info-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–µ–∑–¥–∫–µ</div>
            <div class="info-item">
                <span class="info-label">–ê–¥—Ä–µ—Å:</span>
                <span class="info-value" id="currentAddress">-</span>
            </div>
            <div class="info-item">
                <div class="info-label">–°—Ç–æ–∏–º–æ—Å—Ç—å:</div>
                <div class="info-value-container">
                    <span class="info-value" id="currentPrice">- —Ä—É–±</span>
                    <div class="price-control">
                        <button id="togglePriceBtn" class="price-button">–°–∫—Ä—ã—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="time-panel" style="display: none;" id="timePanel">
            <div class="time-title">–í—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏</div>
            <div class="time-item">
                <span class="time-label">–í—Å–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏:</span>
                <span class="time-value" id="totalTime">0 –º–∏–Ω</span>
            </div>
            <div class="time-item">
                <span class="time-label">–ü—Ä–æ—à–ª–æ:</span>
                <span class="time-value" id="elapsedTime">0:00</span>
            </div>
            <div class="time-item">
                <span class="time-label">–û—Å—Ç–∞–ª–æ—Å—å:</span>
                <span class="time-value" id="remainingTime">0:00</span>
            </div>
        </div>
        
        <div class="instructions">
            –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ç–∞–∫—Å–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é –ø–æ–µ–∑–¥–∫—É
        </div>
        
        <div class="sound-controls">
            <div class="sound-control-group">
                <span class="sound-label">–î–≤–∏–≥–∞—Ç–µ–ª—å:</span>
                <button id="engineSoundToggle" class="sound-button" title="–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫ –¥–≤–∏–≥–∞—Ç–µ–ª—è">
                    <span id="engineIcon">üîä</span>
                </button>
            </div>
            
            <div class="sound-control-group">
                <span class="sound-label">–°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è:</span>
                <button id="crashSoundToggle" class="sound-button" title="–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π">
                    <span id="crashIcon">üí•</span>
                </button>
            </div>
            
            <div class="sound-control-group">
                <span class="sound-label">–î–≤–µ—Ä–∏/–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ:</span>
                <button id="otherSoundToggle" class="sound-button" title="–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –¥—Ä—É–≥–∏–µ –∑–≤—É–∫–∏">
                    <span id="otherIcon">üéµ</span>
                </button>
            </div>
            
            <div class="sound-status" id="soundStatus">
                –í—Å–µ –∑–≤—É–∫–∏ –≤–∫–ª—é—á–µ–Ω—ã
            </div>
        </div>
        
        <div class="car-effects">
            –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–≤—É–∫–∞–º–∏ –æ—Ç–¥–µ–ª—å–Ω–æ
        </div>
    </div>

    <!-- –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç—ã -->
    <audio id="engineSound" loop>
        <!-- –ó–≤—É–∫ –¥–≤–∏–≥–∞—Ç–µ–ª—è –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ Web Audio API -->
    </audio>
    
    <audio id="crashSound" preload="auto">
        <!-- –ó–≤—É–∫ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ Web Audio API -->
    </audio>
    
    <audio id="doorSound" preload="auto">
        <!-- –ó–≤—É–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–≤–µ—Ä–∏ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ Web Audio API -->
    </audio>
    
    <audio id="completionSound" preload="auto">
        <!-- –ó–≤—É–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–µ–∑–¥–∫–∏ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ Web Audio API -->
    </audio>

    <script>
        // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã DOM
        const gameContainer = document.getElementById('gameContainer');
        const roadCanvas = document.getElementById('roadCanvas');
        const taxiElement = document.getElementById('taxi');
        const orderModal = document.getElementById('orderModal');
        const taxiForm = document.getElementById('taxiForm');
        const completionMessage = document.getElementById('completionMessage');
        const backToMenuButton = document.getElementById('backToMenu');
        const tripInfo = document.getElementById('tripInfo');
        const currentAddress = document.getElementById('currentAddress');
        const currentPrice = document.getElementById('currentPrice');
        const togglePriceBtn = document.getElementById('togglePriceBtn');
        const timePanel = document.getElementById('timePanel');
        const totalTimeElement = document.getElementById('totalTime');
        const elapsedTimeElement = document.getElementById('elapsedTime');
        const remainingTimeElement = document.getElementById('remainingTime');
        const finalPrice = document.getElementById('finalPrice');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–≤—É–∫–æ–º
        const engineSoundToggle = document.getElementById('engineSoundToggle');
        const crashSoundToggle = document.getElementById('crashSoundToggle');
        const otherSoundToggle = document.getElementById('otherSoundToggle');
        const engineIcon = document.getElementById('engineIcon');
        const crashIcon = document.getElementById('crashIcon');
        const otherIcon = document.getElementById('otherIcon');
        const soundStatus = document.getElementById('soundStatus');
        
        const carEffectsContainer = document.getElementById('carEffects');
        const cityLightsContainer = document.getElementById('cityLights');
        
        const ctx = roadCanvas.getContext('2d');
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã canvas
        roadCanvas.width = gameContainer.clientWidth;
        roadCanvas.height = gameContainer.clientHeight;
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
        let isTaxiMoving = false;
        let taxiX = 100;
        let taxiY = 300;
        let taxiAngle = 0;
        let taxiSpeed = 0;
        let taxiPath = [];
        let tripTimeMinutes = 0; // –í—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏ –≤ –º–∏–Ω—É—Ç–∞—Ö
        let tripPrice = 0;
        let tripAddress = "";
        let animationId = null;
        let tripStartTime = 0; // –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –ø–æ–µ–∑–¥–∫–∏ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
        let tripEndTime = 0; // –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–µ–∑–¥–∫–∏ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
        let timeUpdateInterval = null;
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∑–≤—É–∫–æ–≤
        let audioContext = null;
        let engineSoundEnabled = true;
        let crashSoundEnabled = true;
        let otherSoundEnabled = true;
        let engineSoundSource = null;
        let lastCrashSoundTime = 0;
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏
        let isPriceVisible = true;
        
        // –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è —Ç–∞–∫—Å–∏
        taxiElement.style.left = `${taxiX - 40}px`;
        taxiElement.style.top = `${taxiY - 20}px`;
        
        // –°–æ–∑–¥–∞–µ–º –≥–æ—Ä–æ–¥—Å–∫–∏–µ –æ–≥–Ω–∏
        function createCityLights() {
            cityLightsContainer.innerHTML = '';
            const lightCount = 50;
            
            for (let i = 0; i < lightCount; i++) {
                const light = document.createElement('div');
                light.className = 'city-lights';
                
                // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –æ–≥–Ω–∏ –ø–æ –∫—Ä–∞—è–º —ç–∫—Ä–∞–Ω–∞
                const isLeftSide = Math.random() > 0.5;
                const x = isLeftSide ? 
                    Math.random() * 100 : 
                    roadCanvas.width - 100 + Math.random() * 100;
                
                const y = Math.random() * roadCanvas.height;
                
                light.style.left = `${x}px`;
                light.style.top = `${y}px`;
                
                // –°–ª—É—á–∞–π–Ω–∞—è —è—Ä–∫–æ—Å—Ç—å
                const brightness = 0.5 + Math.random() * 0.5;
                light.style.opacity = brightness;
                
                // –°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä
                const size = 2 + Math.random() * 4;
                light.style.width = `${size}px`;
                light.style.height = `${size}px`;
                
                cityLightsContainer.appendChild(light);
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–≤—É–∫–æ–≤
        function updateSoundStatus() {
            const enabledSounds = [];
            
            if (engineSoundEnabled) enabledSounds.push("–¥–≤–∏–≥–∞—Ç–µ–ª—å");
            if (crashSoundEnabled) enabledSounds.push("—Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è");
            if (otherSoundEnabled) enabledSounds.push("–¥—Ä—É–≥–∏–µ");
            
            if (enabledSounds.length === 0) {
                soundStatus.textContent = "–í—Å–µ –∑–≤—É–∫–∏ –≤—ã–∫–ª—é—á–µ–Ω—ã";
            } else if (enabledSounds.length === 3) {
                soundStatus.textContent = "–í—Å–µ –∑–≤—É–∫–∏ –≤–∫–ª—é—á–µ–Ω—ã";
            } else {
                soundStatus.textContent = "–í–∫–ª—é—á–µ–Ω—ã: " + enabledSounds.join(", ");
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫–∏
            engineIcon.textContent = engineSoundEnabled ? "üîä" : "üîá";
            crashIcon.textContent = crashSoundEnabled ? "üí•" : "üö´";
            otherIcon.textContent = otherSoundEnabled ? "üéµ" : "üîï";
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–ª–∞—Å—Å—ã –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–∏
            engineSoundToggle.classList.toggle('muted', !engineSoundEnabled);
            crashSoundToggle.classList.toggle('muted', !crashSoundEnabled);
            otherSoundToggle.classList.toggle('muted', !otherSoundEnabled);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
        function togglePriceVisibility() {
            isPriceVisible = !isPriceVisible;
            
            if (isPriceVisible) {
                // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å
                currentPrice.textContent = `${tripPrice} —Ä—É–±`;
                currentPrice.classList.remove('hidden-price');
                togglePriceBtn.textContent = '–°–∫—Ä—ã—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å';
            } else {
                // –°–∫—Ä—ã—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å
                currentPrice.textContent = '*** —Ä—É–±';
                currentPrice.classList.add('hidden-price');
                togglePriceBtn.textContent = '–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å';
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–≤—É–∫–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
        function initAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                createSounds();
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å
                updateSoundStatus();
                
                // –í–∫–ª—é—á–∞–µ–º –∞—É–¥–∏–æ–∫–æ–Ω—Ç–µ–∫—Å—Ç –µ—Å–ª–∏ –æ–Ω –±—ã–ª –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
                if (audioContext.state === 'suspended') {
                    audioContext.resume();
                }
            } catch (e) {
                console.log("Web Audio API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ");
                engineSoundEnabled = false;
                crashSoundEnabled = false;
                otherSoundEnabled = false;
                updateSoundStatus();
            }
        }
        
        // –°–æ–∑–¥–∞–µ–º –∑–≤—É–∫–∏ —Å –ø–æ–º–æ—â—å—é Web Audio API
        function createSounds() {
            if (!audioContext) return;
            
            // –ó–≤—É–∫ –¥–≤–∏–≥–∞—Ç–µ–ª—è (–±–µ–ª—ã–π —à—É–º —Å –Ω–∏–∑–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–æ–º)
            function createEngineSound() {
                const bufferSize = audioContext.sampleRate * 2;
                const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
                const output = buffer.getChannelData(0);
                
                for (let i = 0; i < bufferSize; i++) {
                    output[i] = Math.random() * 2 - 1; // –ë–µ–ª—ã–π —à—É–º
                }
                
                return buffer;
            }
            
            // –ó–≤—É–∫ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è (—Ä–µ–∑–∫–∏–π –Ω–∏–∑–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–π –∑–≤—É–∫)
            function createCrashSound() {
                const duration = 0.5;
                const sampleRate = audioContext.sampleRate;
                const frameCount = sampleRate * duration;
                const buffer = audioContext.createBuffer(1, frameCount, sampleRate);
                const data = buffer.getChannelData(0);
                
                for (let i = 0; i < frameCount; i++) {
                    const time = i / sampleRate;
                    const envelope = Math.exp(-time * 15); // –ë—ã—Å—Ç—Ä–æ –∑–∞—Ç—É—Ö–∞–µ—Ç
                    
                    // –ù–∏–∑–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–π —à—É–º –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ —É–¥–∞—Ä–∞
                    const noise = Math.random() * 2 - 1;
                    const lowFreq = Math.sin(time * 80 * 2 * Math.PI) * 0.3; // –ù–∏–∑–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ –¥–ª—è —É–¥–∞—Ä–∞
                    
                    data[i] = (noise * 0.2 + lowFreq) * envelope;
                }
                
                return buffer;
            }
            
            // –ó–≤—É–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–≤–µ—Ä–∏ (–∫–æ—Ä–æ—Ç–∫–∏–π —É–¥–∞—Ä–Ω—ã–π –∑–≤—É–∫)
            function createDoorSound() {
                const duration = 0.4;
                const sampleRate = audioContext.sampleRate;
                const frameCount = sampleRate * duration;
                const buffer = audioContext.createBuffer(1, frameCount, sampleRate);
                const data = buffer.getChannelData(0);
                
                for (let i = 0; i < frameCount; i++) {
                    const time = i / sampleRate;
                    const envelope = Math.exp(-time * 15);
                    const frequency = 120 + 80 * Math.exp(-time * 30);
                    
                    data[i] = Math.sin(time * frequency * 2 * Math.PI) * envelope * 0.3;
                }
                
                return buffer;
            }
            
            // –ó–≤—É–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–µ–∑–¥–∫–∏ (–∫–æ—Ä–æ—Ç–∫–∏–π –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∑–≤—É–∫)
            function createCompletionSound() {
                const duration = 1.5;
                const sampleRate = audioContext.sampleRate;
                const frameCount = sampleRate * duration;
                const buffer = audioContext.createBuffer(1, frameCount, sampleRate);
                const data = buffer.getChannelData(0);
                
                const notes = [523.25, 659.25]; // C5, E5
                const noteDuration = 0.3;
                
                for (let i = 0; i < frameCount; i++) {
                    const time = i / sampleRate;
                    const noteIndex = Math.floor(time / noteDuration);
                    
                    if (noteIndex < notes.length) {
                        const noteTime = time - noteIndex * noteDuration;
                        const frequency = notes[noteIndex];
                        const envelope = Math.min(1, noteTime * 20) * Math.max(0, 1 - (noteTime - 0.2) * 10);
                        
                        data[i] = Math.sin(noteTime * frequency * 2 * Math.PI) * envelope * 0.3;
                    } else {
                        data[i] = 0;
                    }
                }
                
                return buffer;
            }
            
            // –°–æ–∑–¥–∞–µ–º –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∑–≤—É–∫–æ–≤—ã–µ –±—É—Ñ–µ—Ä—ã
            window.engineSoundBuffer = createEngineSound();
            window.crashSoundBuffer = createCrashSound();
            window.doorSoundBuffer = createDoorSound();
            window.completionSoundBuffer = createCompletionSound();
        }
        
        // –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∑–≤—É–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è
        function toggleEngineSound() {
            if (!audioContext) return;
            
            engineSoundEnabled = !engineSoundEnabled;
            
            if (engineSoundEnabled) {
                // –ï—Å–ª–∏ —Ç–∞–∫—Å–∏ –¥–≤–∏–∂–µ—Ç—Å—è, –≤–∫–ª—é—á–∞–µ–º –∑–≤—É–∫ –¥–≤–∏–≥–∞—Ç–µ–ª—è
                if (isTaxiMoving) {
                    playEngineSound(taxiSpeed);
                }
            } else {
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–≤—É–∫ –¥–≤–∏–≥–∞—Ç–µ–ª—è
                stopEngineSound();
            }
            
            updateSoundStatus();
        }
        
        // –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∑–≤—É–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
        function toggleCrashSound() {
            crashSoundEnabled = !crashSoundEnabled;
            updateSoundStatus();
        }
        
        // –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –¥—Ä—É–≥–∏—Ö –∑–≤—É–∫–æ–≤
        function toggleOtherSound() {
            otherSoundEnabled = !otherSoundEnabled;
            updateSoundStatus();
        }
        
        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è
        function playEngineSound(speed) {
            if (!audioContext || !engineSoundEnabled || !window.engineSoundBuffer) return;
            
            stopEngineSound();
            
            engineSoundSource = audioContext.createBufferSource();
            engineSoundSource.buffer = window.engineSoundBuffer;
            engineSoundSource.loop = true;
            
            // –°–æ–∑–¥–∞–µ–º —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–≤—É–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏
            const filter = audioContext.createBiquadFilter();
            filter.type = 'lowpass';
            filter.frequency.value = 150 + speed * 80; // –ß–∞—Å—Ç–æ—Ç–∞ —Ñ–∏–ª—å—Ç—Ä–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏
            
            // –°–æ–∑–¥–∞–µ–º —É—Å–∏–ª–µ–Ω–∏–µ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç–∏
            const gainNode = audioContext.createGain();
            gainNode.gain.value = 0.08 + speed * 0.03; // –¢–∏—à–µ, —á—Ç–æ–±—ã –Ω–µ —Ä–∞–∑–¥—Ä–∞–∂–∞—Ç—å
            
            engineSoundSource.connect(filter);
            filter.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            engineSoundSource.start();
        }
        
        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–≤—É–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è
        function stopEngineSound() {
            if (engineSoundSource) {
                engineSoundSource.stop();
                engineSoundSource = null;
            }
        }
        
        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
        function playCrashSound() {
            if (!audioContext || !crashSoundEnabled || !window.crashSoundBuffer) return;
            
            const now = Date.now();
            if (now - lastCrashSoundTime < 500) return; // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–≤—É–∫–æ–≤ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
            
            lastCrashSoundTime = now;
            
            const source = audioContext.createBufferSource();
            source.buffer = window.crashSoundBuffer;
            
            const gainNode = audioContext.createGain();
            gainNode.gain.value = 0.4;
            
            source.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            source.start();
        }
        
        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–≤–µ—Ä–∏
        function playDoorSound() {
            if (!audioContext || !otherSoundEnabled || !window.doorSoundBuffer) return;
            
            const source = audioContext.createBufferSource();
            source.buffer = window.doorSoundBuffer;
            
            const gainNode = audioContext.createGain();
            gainNode.gain.value = 0.4;
            
            source.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            source.start();
        }
        
        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–µ–∑–¥–∫–∏
        function playCompletionSound() {
            if (!audioContext || !otherSoundEnabled || !window.completionSoundBuffer) return;
            
            const source = audioContext.createBufferSource();
            source.buffer = window.completionSoundBuffer;
            
            const gainNode = audioContext.createGain();
            gainNode.gain.value = 0.4;
            
            source.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            source.start();
        }
        
        // –°–æ–∑–¥–∞–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è –º–∞—à–∏–Ω—ã
        function updateCarEffects() {
            carEffectsContainer.innerHTML = '';
            
            if (!isTaxiMoving) return;
            
            // –≠—Ñ—Ñ–µ–∫—Ç —Ñ–∞—Ä
            const headlightAngle = taxiAngle * Math.PI / 180;
            const headlightX = taxiX + Math.cos(headlightAngle) * 35;
            const headlightY = taxiY + Math.sin(headlightAngle) * 35;
            
            const headlight = document.createElement('div');
            headlight.className = 'light-effect';
            headlight.style.left = `${headlightX}px`;
            headlight.style.top = `${headlightY}px`;
            headlight.style.transform = `rotate(${taxiAngle}deg)`;
            carEffectsContainer.appendChild(headlight);
            
            // –≠—Ñ—Ñ–µ–∫—Ç –≤—ã—Ö–ª–æ–ø–∞
            const exhaustAngle = (taxiAngle + 180) * Math.PI / 180;
            const exhaustX = taxiX + Math.cos(exhaustAngle) * 35;
            const exhaustY = taxiY + Math.sin(exhaustAngle) * 35;
            
            const exhaust = document.createElement('div');
            exhaust.className = 'exhaust-effect';
            exhaust.style.left = `${exhaustX}px`;
            exhaust.style.top = `${exhaustY}px`;
            carEffectsContainer.appendChild(exhaust);
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ —Ç–∞–∫—Å–∏
        taxiElement.addEventListener('click', () => {
            if (!isTaxiMoving) {
                orderModal.classList.add('active');
                playDoorSound();
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
        taxiForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ñ–æ—Ä–º—ã
            tripAddress = document.getElementById('address').value;
            tripPrice = parseInt(document.getElementById('price').value);
            tripTimeMinutes = parseInt(document.getElementById('time').value);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
            if (tripTimeMinutes < 1) tripTimeMinutes = 1;
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
            taxiForm.reset();
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            orderModal.classList.remove('active');
            
            // –ó–≤—É–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–≤–µ—Ä–∏
            playDoorSound();
            
            // –ù–∞—á–∏–Ω–∞–µ–º –ø–æ–µ–∑–¥–∫—É
            startTrip();
        });
        
        // –ö–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é
        backToMenuButton.addEventListener('click', () => {
            completionMessage.classList.remove('active');
            tripInfo.style.display = 'none';
            timePanel.style.display = 'none';
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
            if (timeUpdateInterval) {
                clearInterval(timeUpdateInterval);
                timeUpdateInterval = null;
            }
            
            // –ó–≤—É–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–≤–µ—Ä–∏
            playDoorSound();
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
            resetGame();
        });
        
        // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–≤—É–∫–æ–º
        engineSoundToggle.addEventListener('click', toggleEngineSound);
        crashSoundToggle.addEventListener('click', toggleCrashSound);
        otherSoundToggle.addEventListener('click', toggleOtherSound);
        
        // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
        togglePriceBtn.addEventListener('click', togglePriceVisibility);
        
        // –§—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤ MM:SS
        function formatTime(minutes, seconds) {
            const mins = Math.floor(minutes);
            const secs = Math.floor(seconds);
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–π–º–µ—Ä–æ–≤
        function updateTimers() {
            if (!isTaxiMoving) return;
            
            const currentTime = Date.now();
            const elapsedMilliseconds = currentTime - tripStartTime;
            const totalMilliseconds = tripTimeMinutes * 60 * 1000;
            const remainingMilliseconds = Math.max(0, tripEndTime - currentTime);
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å–µ–∫—É–Ω–¥—ã
            const elapsedSeconds = elapsedMilliseconds / 1000;
            const remainingSeconds = remainingMilliseconds / 1000;
            const totalSeconds = totalMilliseconds / 1000;
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—Ä–µ–º—è
            const elapsedFormatted = formatTime(elapsedSeconds / 60, elapsedSeconds % 60);
            const remainingFormatted = formatTime(remainingSeconds / 60, remainingSeconds % 60);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —ç–∫—Ä–∞–Ω–µ
            elapsedTimeElement.textContent = elapsedFormatted;
            remainingTimeElement.textContent = remainingFormatted;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç—ã –µ—Å–ª–∏ –æ—Å—Ç–∞–ª–æ—Å—å –º–∞–ª–æ –≤—Ä–µ–º–µ–Ω–∏
            if (remainingSeconds <= 30) {
                remainingTimeElement.classList.add('urgent');
            } else {
                remainingTimeElement.classList.remove('urgent');
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –ª–∏ –ø–æ–µ–∑–¥–∫–∞
            if (currentTime >= tripEndTime) {
                completeTrip();
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –Ω–∞—á–∞–ª–∞ –ø–æ–µ–∑–¥–∫–∏
        function startTrip() {
            isTaxiMoving = true;
            taxiSpeed = 2 + Math.random(); // –°–ª—É—á–∞–π–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–µ–∑–¥–∫–∏
            tripStartTime = Date.now();
            tripEndTime = tripStartTime + (tripTimeMinutes * 60 * 1000);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
            currentAddress.textContent = tripAddress.length > 15 ? tripAddress.substring(0, 15) + '...' : tripAddress;
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
            isPriceVisible = true;
            currentPrice.textContent = `${tripPrice} —Ä—É–±`;
            currentPrice.classList.remove('hidden-price');
            togglePriceBtn.textContent = '–°–∫—Ä—ã—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å';
            
            currentPrice.textContent = `${tripPrice} —Ä—É–±`;
            totalTimeElement.textContent = `${tripTimeMinutes} –º–∏–Ω`;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª–∏
            tripInfo.style.display = 'block';
            timePanel.style.display = 'block';
            
            // –û—á–∏—â–∞–µ–º –ø—É—Ç—å
            taxiPath = [];
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
            if (timeUpdateInterval) {
                clearInterval(timeUpdateInterval);
            }
            timeUpdateInterval = setInterval(updateTimers, 100);
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∑–≤—É–∫ –¥–≤–∏–≥–∞—Ç–µ–ª—è, –µ—Å–ª–∏ –æ–Ω –≤–∫–ª—é—á–µ–Ω
            if (engineSoundEnabled) {
                playEngineSound(taxiSpeed);
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            animate();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä—ã —Å—Ä–∞–∑—É
            updateTimers();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
        function animate() {
            if (!isTaxiMoving) return;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é —Ç–∞–∫—Å–∏
            updateTaxiPosition();
            
            // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –¥–æ—Ä–æ–≥—É
            drawRoad();
            
            // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –ø—É—Ç—å —Ç–∞–∫—Å–∏
            drawTaxiPath();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
            updateCarEffects();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é —ç–ª–µ–º–µ–Ω—Ç–∞ —Ç–∞–∫—Å–∏
            taxiElement.style.left = `${taxiX - 40}px`;
            taxiElement.style.top = `${taxiY - 20}px`;
            
            // –í—Ä–∞—â–∞–µ–º —Ç–∞–∫—Å–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            taxiElement.style.transform = `rotate(${taxiAngle}deg)`;
            
            // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∫–∞–¥—Ä –∞–Ω–∏–º–∞—Ü–∏–∏
            animationId = requestAnimationFrame(animate);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ —Ç–∞–∫—Å–∏
        function updateTaxiPosition() {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â—É—é –ø–æ–∑–∏—Ü–∏—é –≤ –ø—É—Ç—å
            taxiPath.push({x: taxiX, y: taxiY});
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É –ø—É—Ç–∏ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            if (taxiPath.length > 500) {
                taxiPath.shift();
            }
            
            // –î–≤–∏–≥–∞–µ–º —Ç–∞–∫—Å–∏
            taxiX += Math.cos(taxiAngle * Math.PI / 180) * taxiSpeed;
            taxiY += Math.sin(taxiAngle * Math.PI / 180) * taxiSpeed;
            
            // –ò–∑–º–µ–Ω—è–µ–º —É–≥–æ–ª –¥–≤–∏–∂–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç–∏
            const turnAmount = (Math.random() - 0.5) * 8;
            taxiAngle += turnAmount;
            
            // –û—Ç—Å–∫–∞–∫–∏–≤–∞–µ–º –æ—Ç –≥—Ä–∞–Ω–∏—Ü
            let hitWall = false;
            
            if (taxiX < 40 || taxiX > roadCanvas.width - 40) {
                taxiAngle = 180 - taxiAngle;
                taxiX = Math.max(40, Math.min(taxiX, roadCanvas.width - 40));
                hitWall = true;
            }
            
            if (taxiY < 40 || taxiY > roadCanvas.height - 40) {
                taxiAngle = -taxiAngle;
                taxiY = Math.max(40, Math.min(taxiY, roadCanvas.height - 40));
                hitWall = true;
            }
            
            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –ø—Ä–∏ —É–¥–∞—Ä–µ –æ —Å—Ç–µ–Ω—É
            if (hitWall) {
                playCrashSound();
            }
            
            // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —É–≥–æ–ª
            taxiAngle = taxiAngle % 360;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –¥–æ—Ä–æ–≥–∏
        function drawRoad() {
            // –û—á–∏—â–∞–µ–º canvas —Å –Ω–µ–±–æ–ª—å—à–∏–º –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º overlay –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ —Å–ª–µ–¥–∞
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, roadCanvas.width, roadCanvas.height);
            
            // –†–∏—Å—É–µ–º —Ä–∞–∑–º–µ—Ç–∫—É –¥–æ—Ä–æ–≥–∏
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 2;
            ctx.setLineDash([20, 15]);
            
            // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è
            ctx.beginPath();
            ctx.moveTo(0, roadCanvas.height / 2);
            ctx.lineTo(roadCanvas.width, roadCanvas.height / 2);
            ctx.stroke();
            
            // –ë–æ–∫–æ–≤—ã–µ –ª–∏–Ω–∏–∏
            ctx.beginPath();
            ctx.moveTo(0, 100);
            ctx.lineTo(roadCanvas.width, 100);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(0, roadCanvas.height - 100);
            ctx.lineTo(roadCanvas.width, roadCanvas.height - 100);
            ctx.stroke();
            
            ctx.setLineDash([]);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –ø—É—Ç–∏ —Ç–∞–∫—Å–∏
        function drawTaxiPath() {
            if (taxiPath.length < 2) return;
            
            // –ì—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ —Å–ª–µ–¥–∞
            const gradient = ctx.createLinearGradient(
                taxiPath[0].x, taxiPath[0].y, 
                taxiPath[taxiPath.length-1].x, taxiPath[taxiPath.length-1].y
            );
            
            gradient.addColorStop(0, 'rgba(255, 204, 0, 0.1)');
            gradient.addColorStop(0.5, 'rgba(255, 221, 0, 0.5)');
            gradient.addColorStop(1, 'rgba(255, 204, 0, 0.8)');
            
            ctx.strokeStyle = gradient;
            ctx.lineWidth = 3;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            
            // –†–∏—Å—É–µ–º –ø—É—Ç—å
            ctx.beginPath();
            ctx.moveTo(taxiPath[0].x, taxiPath[0].y);
            
            for (let i = 1; i < taxiPath.length; i++) {
                ctx.lineTo(taxiPath[i].x, taxiPath[i].y);
            }
            
            ctx.stroke();
            
            // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç —Å–≤–µ—Ç—è—â–µ–≥–æ—Å—è —Å–ª–µ–¥–∞
            ctx.strokeStyle = 'rgba(255, 255, 200, 0.2)';
            ctx.lineWidth = 8;
            
            ctx.beginPath();
            ctx.moveTo(taxiPath[0].x, taxiPath[0].y);
            
            for (let i = 1; i < taxiPath.length; i++) {
                ctx.lineTo(taxiPath[i].x, taxiPath[i].y);
            }
            
            ctx.stroke();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–µ–∑–¥–∫–∏
        function completeTrip() {
            isTaxiMoving = false;
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
            if (timeUpdateInterval) {
                clearInterval(timeUpdateInterval);
                timeUpdateInterval = null;
            }
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–≤—É–∫ –¥–≤–∏–≥–∞—Ç–µ–ª—è
            stopEngineSound();
            
            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
            playCompletionSound();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Ü–µ–Ω—É (–≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ –æ–∫–Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è)
            finalPrice.textContent = `${tripPrice} —Ä—É–±`;
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
            completionMessage.classList.add('active');
        }
        
        // –§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ –∏–≥—Ä—ã
        function resetGame() {
            isTaxiMoving = false;
            taxiX = 100;
            taxiY = 300;
            taxiAngle = 0;
            taxiSpeed = 0;
            taxiPath = [];
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
            isPriceVisible = true;
            currentPrice.textContent = `${tripPrice} —Ä—É–±`;
            currentPrice.classList.remove('hidden-price');
            togglePriceBtn.textContent = '–°–∫—Ä—ã—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å';
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é —Ç–∞–∫—Å–∏
            taxiElement.style.left = `${taxiX - 40}px`;
            taxiElement.style.top = `${taxiY - 20}px`;
            taxiElement.style.transform = `rotate(0deg)`;
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
            if (timeUpdateInterval) {
                clearInterval(timeUpdateInterval);
                timeUpdateInterval = null;
            }
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–≤—É–∫ –¥–≤–∏–≥–∞—Ç–µ–ª—è
            stopEngineSound();
            
            // –û—á–∏—â–∞–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
            carEffectsContainer.innerHTML = '';
            
            // –û—á–∏—â–∞–µ–º canvas
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, roadCanvas.width, roadCanvas.height);
            
            // –†–∏—Å—É–µ–º –∑–¥–∞–Ω–∏—è –∑–∞–Ω–æ–≤–æ
            drawBuildings();
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('resize', () => {
            roadCanvas.width = gameContainer.clientWidth;
            roadCanvas.height = gameContainer.clientHeight;
            
            // –ï—Å–ª–∏ —Ç–∞–∫—Å–∏ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–≥–æ
            if (taxiX > roadCanvas.width - 40) taxiX = roadCanvas.width - 40;
            if (taxiY > roadCanvas.height - 40) taxiY = roadCanvas.height - 40;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç—Ä–∏—Å–æ–≤–∫—É
            if (!isTaxiMoving) {
                drawRoad();
                drawBuildings();
                createCityLights();
            }
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            drawRoad();
            drawBuildings();
            createCityLights();
            initAudio();
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ "–∑–¥–∞–Ω–∏—è" –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç–∏
        function drawBuildings() {
            ctx.fillStyle = 'rgba(30, 30, 40, 0.8)';
            
            // –†–∏—Å—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ –∫–∞–∫ –∑–¥–∞–Ω–∏—è
            for (let i = 0; i < 8; i++) {
                const x = Math.random() * roadCanvas.width;
                const y = Math.random() * roadCanvas.height;
                const width = 40 + Math.random() * 60;
                const height = 60 + Math.random() * 120;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ–±—ã –∑–¥–∞–Ω–∏—è –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–ª–∏ –Ω–∞—á–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é —Ç–∞–∫—Å–∏
                if (x > 150 || y > 150) {
                    ctx.fillRect(x, y, width, height);
                    
                    // –û–∫–Ω–∞ –≤ –∑–¥–∞–Ω–∏—è—Ö
                    ctx.fillStyle = 'rgba(255, 255, 200, 0.3)';
                    for (let wx = 0; wx < 3; wx++) {
                        for (let wy = 0; wy < 5; wy++) {
                            if (Math.random() > 0.5) {
                                ctx.fillRect(
                                    x + 5 + wx * (width / 3), 
                                    y + 5 + wy * (height / 5), 
                                    width / 3 - 8, 
                                    height / 5 - 8
                                );
                            }
                        }
                    }
                    ctx.fillStyle = 'rgba(30, 30, 40, 0.8)';
                }
            }
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
